{"version":3,"names":["_SliceManager","require","_WavFileWriter","_types","SILENCE_SEGMENT_REGEX","RealtimeTranscriber","callbacks","isActive","isTranscribing","vadEnabled","transcriptionQueue","accumulatedData","Uint8Array","wavFileWriter","lastSpeechDetectedTime","lastVadState","lastStatsSnapshot","isProcessingVAD","lastVadProcessTime","vadProcessingQueue","skippedVadCount","transcriptionResults","Map","vadEvents","constructor","dependencies","options","arguments","length","undefined","whisperContext","vadContext","audioStream","fs","audioSliceSec","audioMinSec","maxSlicesInMemory","vadOptions","VAD_PRESETS","default","vadPreset","autoSliceOnSpeechEnd","autoSliceThreshold","transcribeOptions","initialPrompt","promptPreviousSlices","audioOutputPath","logger","vadThrottleMs","vadSkipRatio","sliceManager","SliceManager","onData","handleAudioData","bind","onError","handleError","onStatusChange","handleAudioStatusChange","start","Error","_this$callbacks$onSta","_this$callbacks","_this$options$audioSt4","_this$options$audioSt5","_this$options$audioSt6","_this$options$audioSt7","_this$options$audioSt8","call","reset","_this$options$audioSt","_this$options$audioSt2","_this$options$audioSt3","WavFileWriter","sampleRate","audioStreamConfig","channels","bitsPerSample","initialize","audioSource","bufferSize","emitStatsUpdate","log","error","_this$callbacks$onSta2","_this$callbacks2","stop","_this$callbacks$onSta3","_this$callbacks3","processAccumulatedDataForSliceManagement","processTranscriptionQueue","finalize","streamData","appendAudioData","data","catch","accumulateAudioData","errorMessage","message","newData","combined","set","minBufferSamples","result","addAudioData","slice","index","queueVADProcessing","queueSliceForTranscription","checkAutoSlice","vadEvent","_slice","shouldTriggerAutoSlice","type","currentSliceInfo","getCurrentSliceInfo","currentSlice","getSliceByIndex","currentSliceIndex","currentDuration","Date","now","startTime","targetDuration","minDuration","meetsMinDuration","meetsThreshold","toFixed","nextSlice","shouldSkip","timeSinceLastVad","push","setTimeout","processVADQueue","processSliceVADThrottled","pop","processSliceVAD","_this$callbacks$onVad","_this$callbacks4","audioData","getAudioDataForTranscription","onBeginVad","duration","shouldProcessVad","sliceIndex","detectSpeech","timestamp","onVad","isSpeech","isSpeechEnd","speechDuration","onBeginTranscribe","shouldTranscribe","get","unshift","currentTimestamp","vadEventType","confidence","audioBuffer","buffer","vadSegments","detectSpeechData","_vadSegments","totalTime","reduce","sum","segment","t1","t0","audioDuration","Math","min","threshold","currentThreshold","isProcessingTranscriptionQueue","item","shift","processTranscription","buildPrompt","promptParts","previousResults","Array","from","entries","filter","_ref","sort","_ref2","_ref3","a","b","map","_ref4","_result$transcribeEve","transcribeEvent","Boolean","join","_this$transcriptionRe","_this$callbacks$onTra","_this$callbacks5","prompt","promise","transcribeData","onProgress","endTime","replace","trim","isCapturing","isRecording","processTime","recordingTime","memoryUsage","getMemoryUsage","previousTranscribe","sampleCount","isProcessed","isReleased","onTranscribe","delete","_this$callbacks$onTra2","_this$callbacks6","errorEvent","_this$callbacks$onErr","_this$callbacks7","updateCallbacks","updateVadOptions","updateAutoSliceOptions","updateVadThrottleOptions","getStatistics","audioStats","accumulatedSamples","vadStats","enabled","contextAvailable","isProcessing","queueSize","skippedCount","throttleMs","skipRatio","sliceStats","autoSliceConfig","getTranscriptionResults","values","_this$callbacks$onTra3","_this$callbacks8","startEvent","forceNextSlice","cancel","clear","release","_this$wavFileWriter","eventType","currentStats","shouldEmitStatsUpdate","_this$callbacks$onSta4","_this$callbacks9","statsEvent","onStatsUpdate","current","previous","_current$sliceStats","_current$sliceStats$m","_previous$sliceStats","_previous$sliceStats$","currentMemory","estimatedMB","previousMemory","memoryDiff","abs","exports"],"sourceRoot":"../../../src","sources":["realtime-transcription/RealtimeTranscriber.ts"],"mappings":"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"}